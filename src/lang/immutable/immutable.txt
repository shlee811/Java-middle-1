<기본형과 참조형의 공유>
자바의 데이터 타입을 가장 크게 보면 기본형(Primitive Type)과 참조형(Reference Type)으로 나눌 수 있다.
**기본형**: 하나의 값을 여러 변수에서 절대로 공유하지 않는다.
**참조형**: 하나의 객체를 참조값을 통해 여러 변수에서 공유할 수 있다.

<공유 참조와 사이드 이펙트>
사이드 이펙트(Side Effect)는 프로그래밍에서 어떤 계산이 주된 작업 외에 추가적인 부수 효과를 일으키는 것을 말한다.
ex)
개발자는 `b` 의 주소값을 서울에서 부산으로 변경할 의도로 값 변경을 시도했다.
하지만 `a`,`b` 는 같은 인스턴스를 참조한다. 따라서 `a` 의 값도 함께 부산으로 변경되어 버린다.

이렇게 주된 작업 외에 추가적인 부수 효과를 일으키는 것을 사이드 이펙트라 한다.
프로그래밍에서 사이드 이펙트는 보통 부정적인 의미로 사용되는데, 사이드 이펙트는 프로그램의 특정 부분에서 발생한 변경이 의도치 않게 다른 부분에
영향을 미치는 경우에 발생한다. 이로 인해 디버깅이 어려워지고 코드의 안정성이 저하될 수 있다.

<사이드 이펙트 해결 방안>
생각해보면 문제의 해결방안은 아주 단순하다. 다음과 같이 `a` 와 `b` 가 처음부터 서로 다른 인스턴스를 참조하면 된다.


<여러 변수가 하나의 객체를 공유하는 것을 막을 방법은 없다>
지금까지 발생한 모든 문제는 같은 객체(인스턴스)를 변수 `a`,`b` 가 함께 공유하기 때문에 발생했다.
따라서 객체를 공유하지 않으면 문제가 해결된다. 여기서 변수 `a` , `b` 가 서로 각각 다른 주소지로 변경할 수 있어야 한다.
이렇게 하려면 서로 다른 객체를 참조하면 된다.

참조값을 다른 변수에 대입하는 순간 여러 변수가 하나의 객체를 공유하게 된다. 쉽게 이야기해서 **객체의 공유를 막을 수 있는 방법이 없다!**
기본형은 항상 값을 복사해서 대입하기 때문에 값이 절대로 공유되지 않는다.
하지만 참조형의 경우 참조값을 복사해서 대입하기 때문에 여러 변수에서 얼마든지 같은 객체를 공유할 수 있다.
객체의 공유가 꼭 필요할 때도 있지만, 때로는 공유하는 것이 지금과 같은 사이드 이펙트를 만드는 경우도 있다
물론 개발자가 눈을 크게 잘 뜨고! 집중에서 코드를 잘 작성하면 사이드 이펙트 문제를 일으키지 않을 수 있다.
하지만 실제로는 훨씬 더 복잡한 상황에서 이런 문제가 발생한다

여러 변수가 하나의 객체를 참조하는 공유 참조를 막을 수 있는 방법은 없다.
그럼 공유 참조로 인해 발생하는 문제를 어떻게 해결할 수 있을까?
단순히 개발자가 공유 참조 문제가 발생하지 않도록 조심해서 코드를 작성해야 할까?

<불변 객체 - 도입>
지금까지 발생한 문제를 잘 생각해보면 공유하면 안되는 객체를 여러 변수에서 공유했기 때문에 발생한 문제이다.
하지만 앞서 살펴보았듯이 객체의 공유를 막을 수 있는 방법은 없다.
그런데 사이드 이펙트의 더 근본적인 원인을 고려해보면, 객체를 공유하는 것 자체는 문제가 아니다.
객체를 공유한다고 바로 사이드 이펙트가 발생하지는 않는다.

**문제의 직접적인 원인은 공유된 객체의 값을 변경한 것에 있다.**

**불변 객체 도입**
객체의 상태(객체 내부의 값, 필드, 멤버 변수)가 변하지 않는 객체를 불변 객체(Immutable Object)라 한다.
앞서 만들었던 `Address` 클래스를 상태가 변하지 않는 불변 클래스로 다시 만들어보자.


**정리**
**불변이라는 단순한 제약을 사용해서 사이드 이펙트라는 큰 문제를 막을 수 있다.**
객체의 공유 참조는 막을 수 없다. 그래서 객체의 값을 변경하면 다른 곳에서 참조하는 변수의 값도 함께 변경되는
사이드 이펙트가 발생한다. 사이드 이펙트가 발생하면 안되는 상황이라면 불변 객체를 만들어서 사용하면 된다.
불변 객체는 값을 변경할 수 없기 때문에 사이드 이펙트가 원천 차단된다.
불변 객체는 값을 변경할 수 없다. 따라서 불변 객체의 값을 변경하고 싶다면 변경하고 싶은 값으로 새로운 불변 객체를 생성해야 한다.
이렇게 하면 기존 변수들이 참조하는 값에는 영향을 주지 않는다.

**참고 - 가변(Mutable) 객체 vs 불변(Immutable) 객체**
가변은 이름 그대로 처음 만든 이후 상태가 변할 수 있다는 뜻이다. (사전적으로 사물의 모양이나 성질이 달라질 수 있다는 뜻이다.)
불변은 이름 그대로 처음 만든 이후 상태가 변하지 않는다는 뜻이다. (사전적으로 사물의 모양이나 성질이 달라질 수 없다는 뜻이다.)

<정리>
지금까지 왜 이렇게 불변 객체 이야기를 많이 했을까?
자바에서 가장 많이 사용되는 `String` 클래스가 바로 불변 객체이기 때문이다. 뿐만 아니라 자바가 기본으로 제공하는
`Integer` , `LocalDate` 등 수 많은 클래스가 불변으로 설계되어 있다. (이후에 학습한다.)
따라서 불변 객체가 필요한 이유와 원리를 제대로 이해해야, 이런 기본 클래스들도 제대로 이해할 수 있다.

**모든 클래스를 불변으로 만드는 것은 아니다.**
우리가 만드는 대부분의 클래스는 값을 변경할 수 있게 만들어진다. 예를 들어서 회원 클래스의 경우 회원의 여러 속성
을 변경할 수 있어야 한다. 가변 클래스가 더 일반적이고, 불변 클래스는 값을 변경하면 안되는 특별한 경우에 만들어서
사용한다고 생각하면 된다. 때로는 같은 기능을 하는 클래스를 하나는 불변으로 하나는 가변으로 각각 만드는 경우도 있다.

클래스를 불변으로 설계하는 이유는 더 많다.
-캐시 안정성
-멀티 쓰레드 안정성
-엔티티의 값 타입

지금은 이런 부분을 다 이해할 수 없다. 관련 내용을 학습하다 보면 자연스럽게 이번에 배운 불변 객체가 떠오르면서
관련된 내용을 본질적으로 더 잘 이해할 수 있을 것이다. 프로그래밍을 더 깊이있게 학습할 수 록 다양한 불변 클래스 이용
사례를 만나고 이해하게 된다.
따라서 **지금은 불변 클래스가 어디에 사용되고, 어떻게 활용되는지 보다는 불변 클래스의 원리를 이해하는 정도면 충분하다.**